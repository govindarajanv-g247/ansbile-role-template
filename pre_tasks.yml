---
    - name: '[pre_tasks] Verify Ansible version'
      assert:
          that: ansible_version.full is version_compare('2.9', '>=')
          fail_msg: This Ansible playbook requires Ansible version >= 2.9.1. Current version is {{ ansible_version.full }}
          quiet: yes

    - name: '[pre_tasks] Update repos and upgrade all packages'
      apt:
          update_cache: yes
          upgrade: safe
          force_apt_get: yes

    - name: '[pre_tasks] Create ~/.local/bin directory if missing'
      file:
          path: ~/.local/bin
          state: directory
      become: no

    - name: '[pre_tasks] Add .local/bin to $PATH'
      lineinfile:
          path: ~/.bashrc
          line: PATH="$HOME/.local/bin:$PATH"
      become: no
